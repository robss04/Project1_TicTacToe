"use strict";angular.module("LocalStorageModule").value("prefix","gaWdiDatabase"),angular.module("ticketyApp",["LocalStorageModule","firebase"]).config(["$routeProvider",function(a){a.when("/computer_game_board",{templateUrl:"views/computer_game_board.html",controller:"computerGameBoardCtrl"}).when("/game_board/:id/:mySymbol",{templateUrl:"views/game_board.html",controller:"gameBoardCtrl"}).when("/how_to",{templateUrl:"views/how_to.html",controller:"HowToCtrl"}).when("/match_player",{templateUrl:"views/match_player.html",controller:"MatchPlayerCtrl"}).when("/",{templateUrl:"views/main.html",controller:"mainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("ticketyApp").controller("gameBoardCtrl",["$scope","$routeParams","angularFire","$timeout",function(a,b,c,d){function e(a,b){return!(b>a||a>b)}a.mySymbol=b.mySymbol,a.myTurn=!1,a.turnNum=0,a.endGame=!1,a.gameBoard=[" "," "," "," "," "," "," "," "," "];var f=new Firebase("https://robss04tictactoe.firebaseio.com/room/"+b.id);a.promise=c(f,a,"gameBoard",[]),a.promise.then(function(){a.gameBoard=[" "," "," "," "," "," "," "," "," "],"x"==b.mySymbol?(console.log("I am First Move: Symbol: "+b.mySymbol),a.myTurn=!0):(console.log("I am Second Move: Symbol: "+b.mySymbol),a.myTurn=!1)}),f.on("value",function(b){console.log("wait received"),a.endGame||a.myTurn?console.log("it is my turn but I receive "):null!=b.val()?e(b.val(),a.gameBoard)?console.log("same gameboard"):(console.log("diff gameboard - data from remote"),a.testForLose(a.mySymbol,b.val())?(console.log("opponent won. you lost."),d(function(){window.alert("You lost, try again!")},50),a.endGame=!0):a.testForCat()?(console.log("Cat Won"),a.mySymbol="Cat",a.endGame=!0):(console.log("my turn. I can pick a square"),a.myTurn=!0,a.turnNum++),console.log("After opponent click: turn # "+a.turnNum+"$scope.gameBoard: "+b.val().join(""))):console.log("snapshot is empty")}),a.listenForMyClick=function(b){a.endGame||(a.myTurn&&!a.isOccupied(b)?(console.log("I clicked on index: "+b),a.gameBoard[b]=a.mySymbol,a.testForWin(a.mySymbol,a.gameBoard)?(d(function(){window.alert("You won!")},50),a.endGame=!0):a.testForCat()?(a.mySymbol="Cat",a.endGame=!0):(a.myTurn=!1,a.turnNum++),console.log("After my click: turn # "+a.turnNum+"$scope.gameBoard: "+a.gameBoard.join(""))):alert("It's NOT your turn fool!"))},a.isOccupied=function(b){return"x"===a.gameBoard[b]||"o"===a.gameBoard[b]};var g=["xxx......","...xxx...","......xxx","x..x..x..",".x..x..x.","..x..x..x","x...x...x","..x.x.x.."],h=g.map(function(a){return a.replace(/x/g,"o")});a.testForWin=function(b,c){console.log("hi testForWin has been fired!"),a.gameBoardStr=c.join("");var d=/\s/g,e=a.gameBoardStr.replace(d,".");if(console.log("I'm gameboard string: "+e),"x"==b)var f=g;else var f=h;for(var i=0;i<f.length;i++){var j=new RegExp(f[i],"i");if(e.match(j))return console.log("Pattern Matching success. We Won"),!0}return!1},a.testForLose=function(b,c){var d="x"==b?"o":"x";return a.testForWin(d,c)},a.testForCat=function(){return 9===a.turnNum},a.minutes="00",a.seconds="00",a.totalTimeInSeconds=0,a.startTimer=function(){a.callTimer=d(function b(){a.totalTimeInSeconds+=1,a.minutes=a.zeroPaddingFunc(Math.floor(a.totalTimeInSeconds/60)),a.seconds=a.zeroPaddingFunc(a.totalTimeInSeconds%60),a.callTimer=d(b,1e3)},1e3)},a.endTimer=function(){d.cancel(a.callTimer)},a.resetTimer=function(){a.minutes="00",a.seconds="00",a.totalTimeInSeconds=0,d.cancel(a.callTimer)},a.zeroPaddingFunc=function(a){return a>=0&&10>a?"0"+a:a}}]),angular.module("ticketyApp").controller("computerGameBoardCtrl",["$scope","$rootScope","$timeout","angularFire",function(a,b,c,d){a.name="Tickety",b.current_page="computer_game_board";var e=new Firebase("https://tictactoedata.firebaseio.com/"),f=d(e,a,"leaderData");a.leaderData={name:{}},f.then(function(){console.log("Data loaded!")}),a.getName=function(){a.userName=prompt("What's your name?"),console.log(a.userName)},a.addWinToLeaderBoard=function(){a.userName&&(a.leaderData.name.hasOwnProperty(a.userName)?a.leaderData.name[a.userName]++:a.leaderData.name[a.userName]=1)},a.click=function(a){console.log("This is "+a)},a.currentSymbol="x",a.turnNum=0,a.cell=[],a.turn=function(){a.turnNum+=1},a.handleClick=function(b){a.notOccupied(b)&&(a.makeNextMove(b,a.currentSymbol),a.isWinning(a.currentSymbol)?(alert(a.currentSymbol+" wins!"),a.restartGame()):(a.swapSymbol(),a.turnNum<9?(a.selectRandomSquare(a.currentSymbol),a.isWinning(a.currentSymbol)?(console.log(a.currentSymbol),console.log(a.cell),alert("O Wins!"),a.restartGame()):a.swapSymbol()):a.swapSymbol())),9==a.turnNum&&(alert("Nobody wins! Try again!"),a.restartGame())},a.makeNextMove=function(b,c){document.getElementById("cell"+b).innerHTML=c,a.cell[b-1]=c,a.turn()},a.swapSymbol=function(){a.currentSymbol="x"==a.currentSymbol?"o":"x"},a.notOccupied=function(a){var b=document.getElementById("cell"+a).innerHTML,c=""==b;return c},a.isWinning=function(b){for(var c=1;9>=c;c+=3)if(a.isSameSymbolsIn(c,c+1,c+2,b))return!0;for(var c=1;3>=c;c++)if(a.isSameSymbolsIn(c,c+3,c+6,b))return!0;return a.isDiagonalSameSymbols(b)},a.isSameSymbolsIn=function(a,b,c,d){var e=document.getElementById("cell"+a).innerHTML==d,f=document.getElementById("cell"+b).innerHTML==d,g=document.getElementById("cell"+c).innerHTML==d,h=e&&f&&g;return h},a.isDiagonalSameSymbols=function(a){var b=document.getElementById("cell1").innerHTML==a&&document.getElementById("cell5").innerHTML==a&&document.getElementById("cell9").innerHTML==a,c=document.getElementById("cell3").innerHTML==a&&document.getElementById("cell5").innerHTML==a&&document.getElementById("cell7").innerHTML==a;return b||c},a.clearBoard=function(){console.log(a.cell);for(var b=1;9>=b;b++){var c=document.getElementById("cell"+b);a.cell[b-1]="",c.innerHTML="",c.classList.remove("x"),c.classList.remove("o")}},a.restartGame=function(){a.currentSymbol="x",a.turnNum=0,a.clearBoard()},a.selectRandomSquare=function(b){var c;do c=Math.floor(9*Math.random()+1);while(!a.notOccupied(c));a.makeNextMove(c,b)},a.minutes="00",a.seconds="00",a.totalTimeInSeconds=0,a.startTimer=function(){a.callTimer=c(function b(){a.totalTimeInSeconds+=1,a.minutes=a.zeroPaddingFunc(Math.floor(a.totalTimeInSeconds/60)),a.seconds=a.zeroPaddingFunc(a.totalTimeInSeconds%60),a.callTimer=c(b,1e3)},1e3)},a.endTimer=function(){c.cancel(a.callTimer)},a.resetTimer=function(){a.minutes="00",a.seconds="00",a.totalTimeInSeconds=0,c.cancel(a.callTimer)},a.zeroPaddingFunc=function(a){return a>=0&&10>a?"0"+a:a}}]),angular.module("ticketyApp").controller("HowToCtrl",["$scope","$rootScope",function(a,b){a.how="Tic Tac Toe is a two-player game. One player is X and the other is O. Players take turns marking the spaces in a 3Ã—3 grid. The player who succeeds first in placing three respective marks in a horizontal, vertical, or diagonal row wins the game.",b.current_page="how_to"}]),angular.module("ticketyApp").controller("mainCtrl",["$scope","$rootScope",function(a,b){console.log("Inside Main"),b.current_page="home_page"}]),angular.module("ticketyApp").controller("MatchPlayerCtrl",["$scope","$rootScope","angularFire","$location","$routeParams",function(a,b,c,d){function e(){return Math.floor(16777215*Math.random()).toString(16)}a.waitingRoom={};var f=new Firebase("https://robss04tictactoe.firebaseio.com/waiting_room");a.promise=c(f,a,"waitingRoom"),a.promise.then(function(){1==a.waitingRoom.xJoined?a.joinWaitingRoom():a.createWaitingRoom()}),a.createWaitingRoom=function(){a.waitingRoom={xJoined:!0,gameBoardNumber:e()},a.noticeMessage="You are x, waiting for opponent.",f.on("child_removed",function(){d.path("game_board/"+a.waitingRoom.gameBoardNumber+"/x/")})},a.joinWaitingRoom=function(){var b=a.waitingRoom.gameBoardNumber;a.waitingRoom={},d.path("game_board/"+b+"/o")},b.current_page="match_player"}]),angular.module("ticketyApp").directive("tickleMe",function(){return{restrict:"A",link:function(a,b){b.bind("click",function(){alert("Don't tickle me!")})}}});